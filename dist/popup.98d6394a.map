{"version":3,"sources":["utils.js","popup.js"],"names":["makeExtensionLogger","ext","mod","log","args","console","apply","undefined","join","err","onError","e","makeLogger","bind","makeGetHostname","parser","document","createElement","getHostname","url","href","hostname","noop","xor","arr","val","arrClone","slice","index","indexOf","splice","concat","getActiveTabDomain","Promise","resolve","browser","tabs","query","active","currentWindow","windowType","map","tab","util","domainTitle","getElementById","setDomainTitleHTML","domain","innerHTML","blockedlist","initialList","setBlockedlistHTML","blocked","list","length","blockedlistHTML","Set","i","classnames","disableButton","initialMessage","value","setDisableButtonVal","disabled","addEventListener","preventDefault","then","storage","sync","get","set","reload","setPopupHTML","setTimeout"],"mappings":"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","file":"popup.98d6394a.map","sourceRoot":"..","sourcesContent":["const makeExtensionLogger = (ext = '', mod = '') => {\n  const log = (...args) =>\n    console.log.apply(undefined, [[ext, mod].join('-'), ...args]);\n  const err = (...args) => log(`Error: `, args);\n  const onError = e => err(e);\n\n  return {\n    log,\n    err,\n    onError\n  };\n};\n\nexport const makeLogger = makeExtensionLogger.bind(undefined, 'DDG');\n\nconst makeGetHostname = () => {\n  let parser = document.createElement('a');\n  const getHostname = url => {\n    parser.href = url;\n    return parser.hostname;\n  };\n  return getHostname;\n};\n\nexport const getHostname = makeGetHostname();\n\nexport const noop = () => undefined;\n\nexport const xor = (arr, val) => {\n  const arrClone = arr.slice(0);\n  const index = arrClone.indexOf(val);\n  if (index >= 0) {\n    arrClone.splice(index, 1);\n    return arrClone;\n  }\n  return arrClone.concat([val]);\n};\n\nexport function getActiveTabDomain() {\n  return new Promise(resolve => {\n    browser.tabs.query(\n      {\n        active: true,\n        currentWindow: true,\n        windowType: 'normal'\n      },\n      tabs => {\n        const [url] = tabs.map(tab => tab.url);\n        resolve(getHostname(url));\n      }\n    );\n  });\n}\n\nconst util = {\n  xor,\n  noop,\n  makeLogger,\n  getHostname,\n  getActiveTabDomain\n};\n\nexport { util as default };\n","import { makeLogger, getActiveTabDomain, xor, noop } from './utils';\n\nconst domainTitle = document.getElementById('domain');\nconst setDomainTitleHTML = domain => {\n  domainTitle.innerHTML = domain;\n};\nconst blockedlist = document.getElementById('blockedlist');\nconst initialList = blockedlist.innerHTML;\nconst setBlockedlistHTML = (blocked, domain) => {\n  const list = blocked[domain] || [];\n  if (list.length === 0) {\n    blockedlist.innerHTML = initialList;\n  } else {\n    const blockedlistHTML = [...new Set(blocked[domain])]\n      .map((hostname, i) => {\n        const classnames = i % 2 === 1 ? 'ph3 pv2' : 'ph3 pv2 stripe-dark';\n        return `<li class=\"${classnames}\">${hostname}</li>`;\n      })\n      .join('');\n    blockedlist.innerHTML = blockedlistHTML;\n  }\n};\nconst disableButton = document.getElementById('disable');\nconst initialMessage = disableButton.value;\nconst setDisableButtonVal = (disabled, domain) => {\n  if (disabled.indexOf(domain) >= 0) {\n    disableButton.value = `Re-enable blocking for ${domain}`;\n  } else {\n    disableButton.value = initialMessage;\n  }\n};\n\ndisableButton.addEventListener('click', e => {\n  e.preventDefault();\n  log('clicked');\n  getActiveTabDomain().then(domain => {\n    browser.storage.sync.get().then(({ disabled, blocked }) => {\n      browser.storage.sync\n        .set({\n          disabled: xor(disabled, domain),\n          blocked: { ...blocked, [domain]: [] }\n        })\n        .then(() => {\n          browser.storage.sync.get().then(({ disabled, blocked }) => {\n            setBlockedlistHTML(blocked, domain);\n            setDisableButtonVal(disabled, domain);\n            browser.tabs.reload().then(() => {});\n          });\n        });\n    });\n  });\n});\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  const setPopupHTML = () => {\n    getActiveTabDomain().then(domain => {\n      browser.storage.sync\n        .get()\n        .then(({ blocked, disabled }) => {\n          setDomainTitleHTML(domain);\n          setBlockedlistHTML(blocked, domain);\n          setDisableButtonVal(disabled, domain);\n          setTimeout(setPopupHTML, 1500);\n        })\n        .then(noop);\n    });\n  };\n  setPopupHTML();\n});\n"]}