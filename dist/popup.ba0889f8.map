{"version":3,"sources":["utils.js","popup.js"],"names":["makeExtensionLogger","ext","mod","log","args","console","apply","undefined","join","err","onError","e","makeLogger","bind","makeGetHostname","parser","document","createElement","getHostname","url","href","hostname","noop","xor","arr","val","arrClone","slice","index","indexOf","splice","concat","getActiveTabDomain","Promise","resolve","browser","tabs","query","active","currentWindow","windowType","map","tab","util","domainTitle","getElementById","setDomainTitleHTML","domain","innerHTML","blockedlist","initialList","setBlockedlistHTML","blocked","list","length","blockedlistHTML","Set","i","classnames","disableButton","initialMessage","value","setDisableButtonVal","disabled","addEventListener","preventDefault","then","storage","sync","get","set","reload","setPopupHTML","setTimeout"],"mappings":"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","file":"popup.ba0889f8.map","sourceRoot":"..","sourcesContent":["const makeExtensionLogger = (ext = '', mod = '') => {\n  const log = (...args) =>\n    console.log.apply(undefined, [[ext, mod].join('-'), ...args]);\n  const err = (...args) => log(`Error: `, args);\n  const onError = e => err(e);\n\n  return {\n    log,\n    err,\n    onError\n  };\n};\n\nexport const makeLogger = makeExtensionLogger.bind(undefined, 'DDG');\n\nconst makeGetHostname = () => {\n  let parser = document.createElement('a');\n  const getHostname = url => {\n    parser.href = url;\n    return parser.hostname;\n  };\n  return getHostname;\n};\n\nexport const getHostname = makeGetHostname();\n\nexport const noop = () => undefined;\n\nexport const xor = (arr, val) => {\n  const arrClone = arr.slice(0);\n  const index = arrClone.indexOf(val);\n  if (index >= 0) {\n    arrClone.splice(index, 1);\n    return arrClone;\n  }\n  return arrClone.concat([val]);\n};\n\nexport function getActiveTabDomain() {\n  return new Promise(resolve => {\n    browser.tabs.query(\n      {\n        active: true,\n        currentWindow: true,\n        windowType: 'normal'\n      },\n      tabs => {\n        const [url] = tabs.map(tab => tab.url);\n        resolve(getHostname(url));\n      }\n    );\n  });\n}\n\nconst util = {\n  xor,\n  noop,\n  makeLogger,\n  getHostname,\n  getActiveTabDomain\n};\n\nexport { util as default };\n","import { makeLogger, getActiveTabDomain, xor, noop } from './utils';\nconst log = makeLogger('POP');\nconst domainTitle = document.getElementById('domain');\nconst setDomainTitleHTML = domain => {\n  domainTitle.innerHTML = domain;\n};\nconst blockedlist = document.getElementById('blockedlist');\nconst initialList = blockedlist.innerHTML;\nconst setBlockedlistHTML = (blocked, domain) => {\n  const list = blocked[domain] || [];\n  if (list.length === 0) {\n    blockedlist.innerHTML = initialList;\n  } else {\n    const blockedlistHTML = [...new Set(blocked[domain])]\n      .map((hostname, i) => {\n        const classnames = i % 2 === 1 ? 'ph3 pv2' : 'ph3 pv2 stripe-dark';\n        return `<li class=\"${classnames}\">${hostname}</li>`;\n      })\n      .join('');\n    blockedlist.innerHTML = blockedlistHTML;\n  }\n};\nconst disableButton = document.getElementById('disable');\nconst initialMessage = disableButton.value;\nconst setDisableButtonVal = (disabled, domain) => {\n  if (disabled.indexOf(domain) >= 0) {\n    disableButton.value = `Re-enable blocking for ${domain}`;\n  } else {\n    disableButton.value = initialMessage;\n  }\n};\n\ndisableButton.addEventListener('click', e => {\n  e.preventDefault();\n  getActiveTabDomain().then(domain => {\n    browser.storage.sync.get().then(({ disabled = [], blocked = {} }) => {\n      browser.storage.sync\n        .set({\n          disabled: xor(disabled, domain),\n          blocked: { ...blocked, [domain]: [] }\n        })\n        .then(() => {\n          browser.storage.sync.get().then(({ disabled = [], blocked = {} }) => {\n            setBlockedlistHTML(blocked, domain);\n            setDisableButtonVal(disabled, domain);\n            browser.tabs.reload().then(() => {});\n          });\n        });\n    });\n  });\n});\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  const setPopupHTML = () => {\n    getActiveTabDomain().then(domain => {\n      browser.storage.sync\n        .get()\n        .then(({ blocked = {}, disabled = [] }) => {\n          setDomainTitleHTML(domain);\n          setBlockedlistHTML(blocked, domain);\n          setDisableButtonVal(disabled, domain);\n          setTimeout(setPopupHTML, 1500);\n        })\n        .then(noop);\n    });\n  };\n  setPopupHTML();\n});\n"]}